From 82ab3ede725238e6b1bbf544b334a0d7e4391f5c Mon Sep 17 00:00:00 2001
From: kongfl888 <kongfl888@outlook.com>
Date: Wed, 8 Jul 2020 01:59:57 +0800
Subject: [PATCH] enable_autocore_1907

---
 package/lean/autocore/Makefile                | 2 +-
 package/lean/autocore/files/cpuinfo           | 4 ++--
 package/lean/autocore/files/rpcd_10_system.js | 5 +++--
 3 files changed, 6 insertions(+), 5 deletions(-)

diff --git a/package/lean/autocore/Makefile b/package/lean/autocore/Makefile
index 22b986d..d6acbe4 100644
--- a/package/lean/autocore/Makefile
+++ b/package/lean/autocore/Makefile
@@ -17,7 +17,7 @@ include $(INCLUDE_DIR)/package.mk
 define Package/autocore
   TITLE:=x86/x64 auto core loadbalance script.
   MAINTAINER:=Lean
-  DEPENDS:=@TARGET_x86 +bc +lm-sensors +ethtool
+  DEPENDS:=bc +lm-sensors +ethtool
 endef
 
 define Package/autocore/description
diff --git a/package/lean/autocore/files/cpuinfo b/package/lean/autocore/files/cpuinfo
index 8c0527f..6adabea 100644
--- a/package/lean/autocore/files/cpuinfo
+++ b/package/lean/autocore/files/cpuinfo
@@ -1,5 +1,5 @@
 #!/bin/sh
 
-MHz=`grep 'MHz' /proc/cpuinfo | cut -c11- |sed -n '1p'`
-TEMP=`sensors 2>/dev/null | grep 'Core 0' | cut -c12-`
+MHz=`echo "$(cat /sys/devices/system/cpu/cpu[04]/cpufreq/cpuinfo_cur_freq)/1000" | bc`
+TEMP=`echo "scale=2; $(cat /sys/class/thermal/thermal_zone0/temp)/1000" | bc`Â°
 echo "$MHz MHz $TEMP "
diff --git a/package/lean/autocore/files/rpcd_10_system.js b/package/lean/autocore/files/rpcd_10_system.js
index 8c1e788..c805e9f 100644
--- a/package/lean/autocore/files/rpcd_10_system.js
+++ b/package/lean/autocore/files/rpcd_10_system.js
@@ -72,9 +72,10 @@ return L.Class.extend({
 
 		var fields = [
 			_('Hostname'),         boardinfo.hostname,
-			_('Model'),            boardinfo.model + cpubench.cpubench,
+			_('Model'),            "Rockchip RK3328: 4 Core 4 Thread " + cpubench.cpubench,
 			_('CPU Info'),         cpuinfo.cpuinfo,
-			_('Firmware Version'), (L.isObject(boardinfo.release) ? boardinfo.release.description + ' / ' : '') + (luciversion || ''),
+			_('Architecture'),     'ARMv8 / Cortex-A53,64-bit',
+			_('Firmware Version'), (L.isObject(boardinfo.release) ? boardinfo.release.description + ' / ' : '') + (luciversion || '') + ' built by Mr.K',
 			_('Kernel Version'),   boardinfo.kernel,
 			_('Local Time'),       datestr,
 			_('Uptime'),           systeminfo.uptime ? '%t'.format(systeminfo.uptime) : null,
-- 
2.14.1.windows.1

