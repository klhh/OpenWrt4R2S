From: kongfl888 <kongfl888@outlook.com>
Date: Sat, 27 Jun 2020 03:26:30 +0800
Subject: [PATCH] enable_autocore_1907

---
 package/lean/autocore/Makefile                | 2 +-
 package/lean/autocore/files/cpuinfo           | 4 ++--
 package/lean/autocore/files/rpcd_10_system.js | 3 ++-
 3 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/package/lean/autocore/Makefile b/package/lean/autocore/Makefile
index efdba91..c783b83 100644
--- a/package/lean/autocore/Makefile
+++ b/package/lean/autocore/Makefile
@@ -17,7 +17,7 @@ include $(INCLUDE_DIR)/package.mk
 define Package/autocore
   TITLE:=x86/x64 auto core loadbalance script.
   MAINTAINER:=Lean
-  DEPENDS:=@TARGET_x86 +bc +lm-sensors +ethtool
+  DEPENDS:=+bc +lm-sensors +ethtool
 endef
 
 define Package/autocore/description
diff --git a/package/lean/autocore/files/cpuinfo b/package/lean/autocore/files/cpuinfo
index 19ea5fb..60e7acd 100644
--- a/package/lean/autocore/files/cpuinfo
+++ b/package/lean/autocore/files/cpuinfo
@@ -2,7 +2,7 @@
 
 info()
 {
-	MHz=`grep 'MHz' /proc/cpuinfo | cut -c11- |sed -n '1p'`
+	MHz=`echo "$(cat /sys/devices/system/cpu/cpu[04]/cpufreq/cpuinfo_cur_freq)/1000" | bc`
 	#获取CPU工作频率
 
 	sensors >/dev/null
@@ -12,7 +12,7 @@ info()
 		#获取CPU核心1温度
 
 	else
-		a=""
+		a=`echo "scale=2; $(cat /sys/class/thermal/thermal_zone0/temp)/1000" | bc`°
 	fi
 }
 
diff --git a/package/lean/autocore/files/rpcd_10_system.js b/package/lean/autocore/files/rpcd_10_system.js
index 8c1e788..9d69c16 100644
--- a/package/lean/autocore/files/rpcd_10_system.js
+++ b/package/lean/autocore/files/rpcd_10_system.js
@@ -74,7 +74,8 @@ return L.Class.extend({
 			_('Hostname'),         boardinfo.hostname,
 			_('Model'),            boardinfo.model + cpubench.cpubench,
 			_('CPU Info'),         cpuinfo.cpuinfo,
-			_('Firmware Version'), (L.isObject(boardinfo.release) ? boardinfo.release.description + ' / ' : '') + (luciversion || ''),
+			_('Architecture'),     'ARMv8 / Cortex-A53,64-bit (Rockchip rk3328)',
+			_('Firmware Version'), (L.isObject(boardinfo.release) ? boardinfo.release.description + ' / ' : '') + (luciversion || '') + ' built by Mr.K',
 			_('Kernel Version'),   boardinfo.kernel,
 			_('Local Time'),       datestr,
 			_('Uptime'),           systeminfo.uptime ? '%t'.format(systeminfo.uptime) : null,

